<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Brazenhead by leandog</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Brazenhead</h1>
        <p>Low-level driver for instrumenting Android applications.</p>

        <p class="view"><a href="https://github.com/leandog/brazenhead">View the Project on GitHub <small>leandog/brazenhead</small></a></p>


        <ul>
          <li><a href="https://github.com/leandog/brazenhead/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/leandog/brazenhead/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/leandog/brazenhead">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>Brazenhead</h1>

<p><a href="http://travis-ci.org/leandog/brazenhead"><img src="https://secure.travis-ci.org/leandog/brazenhead.png?branch=master" alt="Build Status"></a></p>

<p>A low-level driver for testing android applications.</p>

<h2>Basic Usage</h2>

<p>Brazenhead works by modifying your Android application (apk).  Once modified and installed in an emulator or device, brazenhead can send request to the emulator or device and cause it to interact with your application via the <a href="http://code.google.com/p/robotium/">Robotium API</a>.</p>

<h3>Prerequisites</h3>

<p>Before being able to instrument your application, you will need to add the <code>INTERNET</code> permission to your <code>AndroidManifest.xml</code>.</p>

<div class="highlight"><pre><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.INTERNET"</span> <span class="nt">/&gt;</span>
</pre></div>

<h3>Starting Instrumentation</h3>

<p>To start instrumenting an application you must create an instance of the <code>Brazenhead::Server</code> by giving it the path to your android application (apk) an optionally some keystore information.  (<strong><em>note:</em></strong> <em>If no keystore information is provided, the <code>debug.keystore</code> will be used instead.</em>)</p>

<div class="highlight"><pre><span class="nb">require</span> <span class="s1">'brazenhead/server'</span>

<span class="c1"># using the debug.keystore</span>
<span class="n">server</span> <span class="o">=</span> <span class="no">Brazenhead</span><span class="o">::</span><span class="no">Server</span><span class="o">.</span><span class="n">new</span> <span class="s2">"some/path/to/my.apk"</span>
</pre></div>

<p>Now that you have a server instance, you can simply start any activity by giving it the name of the activity.  <code>brazenhead</code> will assume that it is a relative path based on the package name of your application.  If the package of your application is <code>com.example.some.awesome.app</code>, you can simply start the activity at <code>com.example.some.awesome.app.text.Flashy</code> like so:</p>

<div class="highlight"><pre><span class="c1"># create the server instance</span>
<span class="n">server</span> <span class="o">=</span> <span class="no">Brazenhead</span><span class="o">::</span><span class="no">Server</span><span class="o">.</span><span class="n">new</span> <span class="s2">"some/path/to/my.apk"</span>

<span class="c1">#start the activity</span>
<span class="n">server</span><span class="o">.</span><span class="n">start</span> <span class="s2">"text.Flashy"</span>
</pre></div>

<h3>Stopping Tests</h3>

<p>Stopping the server instance is just as easy.  Simply issue the following to stop the test server:</p>

<div class="highlight"><pre><span class="n">server</span><span class="o">.</span><span class="n">stop</span>
</pre></div>

<h3>Sending Commands</h3>

<p>Messages sent to the emulator are json messages and  must take the form of </p>

<div class="highlight"><pre><span class="p">{</span> 
  <span class="nb">name</span><span class="p">:</span> <span class="s1">'theMethodName'</span><span class="p">,</span>  <span class="c1"># The Robotium method to call</span>
  <span class="n">arguments</span><span class="p">:</span> <span class="o">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">]</span><span class="p">,</span>   <span class="c1"># The arguments to be passed to the Robotium method</span>
  <span class="n">variable</span><span class="p">:</span> <span class="s2">"@@variable_name_to_store_the_results@@"</span><span class="p">,</span>  <span class="c1"># optional parameter to store the results </span>
                                                       <span class="c1"># of a call - can be used in subsequent calls</span>
  <span class="n">target</span><span class="p">:</span>  <span class="s1">'Robotium'</span>     <span class="c1"># optional parameter.  Valid values are 'Robotium' or 'LastResultOrRobotium'</span>
<span class="p">}</span>
</pre></div>

<p>The <code>variable</code> parameter can be used in subsequent calls as an argument value.</p>

<p>In addition to a server process there is a ruby module that will build the json for you when you call corresponding methods.  Let's take a look at a few examples of how this works.</p>

<p>You can include the <code>Brazenhead</code> module in your class to provide the abilities.</p>

<div class="highlight"><pre><span class="k">class</span> <span class="nc">MyClass</span>
  <span class="kp">include</span> <span class="no">Brazenhead</span>
<span class="k">end</span>
</pre></div>

<p>Once you do this you can call methods on an instance of <code>MyClass</code>.  These methods look like this:</p>

<h3>Calling a single method</h3>

<div class="highlight"><pre><span class="n">my_class</span><span class="o">.</span><span class="n">scroll_down</span>  <span class="c1"># call the scrollDown method on Robotium</span>
</pre></div>

<p>You can also pass parameters to methods like this:</p>

<div class="highlight"><pre><span class="n">my_class</span><span class="o">.</span><span class="n">click_on_text</span><span class="p">(</span><span class="s1">'Content'</span><span class="p">)</span>  <span class="c1"># will call the method clickOnText passing 'Content'</span>
</pre></div>

<h3>Calling multiple methods</h3>

<div class="highlight"><pre><span class="n">my_class</span><span class="o">.</span><span class="n">chain_calls</span> <span class="k">do</span> <span class="o">|</span><span class="n">driver</span><span class="o">|</span>
  <span class="n">driver</span><span class="o">.</span><span class="n">scroll_down</span>                         <span class="c1"># call scrollDown first</span>
  <span class="n">driver</span><span class="o">.</span><span class="n">scroll_up</span><span class="p">({</span><span class="ss">:target</span> <span class="o">=&gt;</span> <span class="s1">'Robotium'</span><span class="p">})</span>  <span class="c1"># then call scrollUp</span>
<span class="k">end</span>
</pre></div>

<p>In the case above we had to pass a <code>target</code> value to inform the server that we wished to make the second call directly on Robotium instead of on the return call from the previous call.  You can easily make the second call on the return value from the first call like this:</p>

<div class="highlight"><pre><span class="n">my_class</span><span class="o">.</span><span class="n">chain_calls</span> <span class="k">do</span> <span class="o">|</span><span class="n">driver</span><span class="o">|</span>
  <span class="n">driver</span><span class="o">.</span><span class="n">get_current_list_views</span>
  <span class="n">driver</span><span class="o">.</span><span class="n">size</span>
<span class="k">end</span>
<span class="n">my_class</span><span class="o">.</span><span class="n">last_response</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">should</span> <span class="o">==</span> <span class="s1">'1'</span>
</pre></div>

<p>In the above example the <code>size</code> method is called on the result of the call to <code>getCurrentListViews</code>.  If you want to use the result of a previous call as an argument in another call you can do this:</p>

<div class="highlight"><pre><span class="n">my_class</span><span class="o">.</span><span class="n">chain_calls</span> <span class="k">do</span> <span class="o">|</span><span class="n">driver</span><span class="o">|</span>
  <span class="n">driver</span><span class="o">.</span><span class="n">get_text</span><span class="p">(</span><span class="s1">'Graphics'</span><span class="p">,</span> <span class="p">{</span><span class="ss">:variable</span> <span class="o">=&gt;</span> <span class="s2">"@@graphics@@"</span><span class="p">})</span>
  <span class="n">driver</span><span class="o">.</span><span class="n">click_on_view</span><span class="p">(</span><span class="s2">"@@graphics@@"</span><span class="p">,</span> <span class="p">{</span><span class="ss">:target</span> <span class="o">=&gt;</span> <span class="s1">'Robotium'</span><span class="p">})</span>
<span class="k">end</span>
</pre></div>

<p>In this final case we saved the result of the first call into a variable named <code>"@@graphics@@"</code> and used it as an argument in the second call.</p>

<h2>Known Issues</h2>

<p>See <a href="http://github.com/leandog/brazenhead/issues">http://github.com/leandog/brazenhead/issues</a></p>

<h2>Contribute</h2>

<ul>
<li>Fork the project.</li>
<li>Test drive your feature addition or bug fix. Adding specs is important and I will not accept a pull request that does not have tests.</li>
<li>Make sure you describe your new feature with a cucumber scenario.</li>
<li>Make sure you provide RDoc comments for any new public method you add. Remember, others will be using this gem.</li>
<li>Commit, do not mess with Rakefile, version, or ChangeLog.
(if you want to have your own version, that is fine but bump version in a commit by itself I can ignore when I pull)</li>
<li>Send me a pull request. Bonus points for topic branches.</li>
</ul><h2>Copyright</h2>

<p>Copyright (c) 2012 Jeffrey S. Morgan, Levi Wilson. See LICENSE for details.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/leandog">leandog</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>